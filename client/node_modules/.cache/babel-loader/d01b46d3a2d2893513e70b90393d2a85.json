{"ast":null,"code":"var _jsxFileName = \"/Users/jdszsl/Desktop/projects/wb/real-time-whiteboard/client/src/components/whiteboard/Whiteboard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport { FaUndoAlt } from 'react-icons/fa';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\nimport Drawing from './drawing/drawing';\nimport './style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet socket;\n\nconst Whiteboard = ({\n  location\n}) => {\n  _s();\n\n  //const [username, setUsername] = useState('');\n  //const [room, setRoom] = useState('');\n  const [users, setUsers] = useState([]);\n  const [message, setMessage] = useState([]);\n  const history = useHistory();\n  const ENDPOINT = 'localhost:5000';\n  useEffect(() => {\n    const {\n      username,\n      room\n    } = queryString.parse(location.search);\n    socket = io(ENDPOINT);\n    socket.emit('join', {\n      username: username,\n      room: room\n    }, error => {\n      if (error) {\n        alert(error);\n        history.push('/');\n      }\n\n      ;\n    });\n    return () => {\n      socket.emit('disconnected');\n      socket.off();\n    };\n  }, [ENDPOINT, history, location.search]);\n  useEffect(() => {\n    socket.on('message', message => {\n      setMessage(message);\n    });\n    socket.on(\"roomData\", ({\n      users\n    }) => {\n      setUsers(users);\n    });\n  }, [message, users]);\n\n  window.onbeforeunload = () => {\n    socket.emit('disconnected');\n    socket.off(); //return 'refreshing/leaving this page?';\n  };\n\n  window.onhashchange = () => {\n    socket.emit('disconnected');\n    socket.off(); //return 'refreshing/leaving this page?';\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Message:\", message.text]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Current users:\", users.map(user => /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\" \", user.username]\n      }, user.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 21\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      id: \"canvas\",\n      className: \"whiteboard\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"colors\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"color black\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"color red\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"color green\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"color blue\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"color yellow\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"color white\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(FaUndoAlt, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 18\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n      src: \"/socket.io/socket.io.js\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n      children: window.onload = () => {\n        Drawing(socket);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Whiteboard, \"+KHj85VYKWsqppknyxweTzLcpaw=\", false, function () {\n  return [useHistory];\n});\n\n_c = Whiteboard;\nexport default Whiteboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Whiteboard\");","map":{"version":3,"sources":["/Users/jdszsl/Desktop/projects/wb/real-time-whiteboard/client/src/components/whiteboard/Whiteboard.js"],"names":["React","useState","useEffect","useHistory","FaUndoAlt","queryString","io","Drawing","socket","Whiteboard","location","users","setUsers","message","setMessage","history","ENDPOINT","username","room","parse","search","emit","error","alert","push","off","on","window","onbeforeunload","onhashchange","text","map","user","id","onload"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport { FaUndoAlt } from 'react-icons/fa';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\nimport Drawing from './drawing/drawing'\n\nimport './style.css';\n\nlet socket;\n\nconst Whiteboard = ({ location }) => {\n    //const [username, setUsername] = useState('');\n    //const [room, setRoom] = useState('');\n    const [users, setUsers] = useState([]);\n    const [message, setMessage] = useState([]);\n    const history = useHistory();\n    const ENDPOINT = 'localhost:5000';\n\n    useEffect(() => {\n        const { username, room } = queryString.parse(location.search);\n\n        socket = io(ENDPOINT);\n\n        socket.emit('join', { username: username, room: room }, (error) => {\n            if (error) {\n                alert(error);\n                history.push('/');\n            };\n        });\n\n        return () => {\n            socket.emit('disconnected');\n            socket.off();\n        };\n    }, [ENDPOINT, history, location.search]);\n\n    useEffect(() => {\n        socket.on('message', (message) => {\n            setMessage(message);\n        });\n\n        socket.on(\"roomData\", ({ users }) => {\n            setUsers(users);\n        });\n    }, [message, users]);\n\n    window.onbeforeunload = () => {\n        socket.emit('disconnected');\n        socket.off();\n        //return 'refreshing/leaving this page?';\n    };\n\n    window.onhashchange = () => {\n        socket.emit('disconnected');\n        socket.off();\n        //return 'refreshing/leaving this page?';\n    };\n\n    return (\n        <div>\n            <div>\n                Message:{message.text}\n            </div>\n            <div>\n                Current users:\n                {users.map(user => \n                    <span key={user.id}> {user.username}</span>\n                )}\n            </div>\n            \n            <canvas id=\"canvas\" className=\"whiteboard\"></canvas>\n\n            <div className=\"colors\">\n                <div className=\"color black\"></div>\n                <div className=\"color red\"></div>\n                <div className=\"color green\"></div>\n                <div className=\"color blue\"></div>\n                <div className=\"color yellow\"></div>\n                <div className=\"color white\"></div>\n            </div>\n            <div><FaUndoAlt /></div>\n\n            <script src=\"/socket.io/socket.io.js\"></script>\n            <script>\n                {\n                    window.onload = () => {\n                        Drawing(socket);\n                    }\n                }\n            </script>\n        </div>\n    )\n}\n\nexport default Whiteboard;"]},"metadata":{},"sourceType":"module"}